(function(){function b(d,e,g){function a(j,i){if(!e[j]){if(!d[j]){var f="function"==typeof require&&require;if(!i&&f)return f(j,!0);if(h)return h(j,!0);var c=new Error("Cannot find module '"+j+"'");throw c.code="MODULE_NOT_FOUND",c}var k=e[j]={exports:{}};d[j][0].call(k.exports,function(b){var c=d[j][1][b];return a(c||b)},k,k.exports,b,d,e,g)}return e[j].exports}for(var h="function"==typeof require&&require,c=0;c<g.length;c++)a(g[c]);return a}return b})()({1:[function(a,b){"use strict";/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function c(a,c){function b(){this.constructor=a}g(a,c),a.prototype=null===c?Object.create(c):(b.prototype=c.prototype,new b)}function d(a){var b="function"==typeof Symbol&&a[Symbol.iterator],c=0;return b?b.call(a):{next:function(){return a&&c>=a.length&&(a=void 0),{value:a&&a[c++],done:!a}}}}function e(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,f,g=c.call(a),h=[];try{for(;(void 0===b||0<b--)&&!(d=g.next()).done;)h.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=g["return"])&&c.call(g)}finally{if(f)throw f.error}}return h}function f(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(e(arguments[b]));return a}var g=function(a,c){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var b in c)c.hasOwnProperty(b)&&(a[b]=c[b])},g(a,c)},h=function(){function a(a,b){this.target=b,this.type=a}return a}(),i=function(a){function b(b,c){var d=a.call(this,"error",c)||this;return d.message=b.message,d.error=b,d}return c(b,a),b}(h),j=function(a){function b(b,c,d){void 0===b&&(b=1e3),void 0===c&&(c="");var e=a.call(this,"close",d)||this;return e.wasClean=!0,e.code=b,e.reason=c,e}return c(b,a),b}(h),k=function(){if("undefined"!=typeof WebSocket)return WebSocket},l=function(a){return"undefined"!=typeof a&&!!a&&2===a.CLOSING},m={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1},n=function(){function a(a,b,c){var d=this;void 0===c&&(c={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(a){d._debug("open event");var b=d._options.minUptime,c=void 0===b?m.minUptime:b;clearTimeout(d._connectTimeout),d._uptimeTimeout=setTimeout(function(){return d._acceptOpen()},c),d._ws.binaryType=d._binaryType,d._messageQueue.forEach(function(a){return d._ws.send(a)}),d._messageQueue=[],d.onopen&&d.onopen(a),d._listeners.open.forEach(function(b){return d._callEventListener(a,b)})},this._handleMessage=function(a){d._debug("message event"),d.onmessage&&d.onmessage(a),d._listeners.message.forEach(function(b){return d._callEventListener(a,b)})},this._handleError=function(a){d._debug("error event",a.message),d._disconnect(void 0,"TIMEOUT"===a.message?"timeout":void 0),d.onerror&&d.onerror(a),d._debug("exec error listeners"),d._listeners.error.forEach(function(b){return d._callEventListener(a,b)}),d._connect()},this._handleClose=function(a){d._debug("close event"),d._clearTimeouts(),d._shouldReconnect&&d._connect(),d.onclose&&d.onclose(a),d._listeners.close.forEach(function(b){return d._callEventListener(a,b)})},this._url=a,this._protocols=b,this._options=c,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(a,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(a,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(a,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(a,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"CONNECTING",{get:function(){return a.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"OPEN",{get:function(){return a.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"CLOSING",{get:function(){return a.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"CLOSED",{get:function(){return a.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(a){this._binaryType=a,this._ws&&(this._ws.binaryType=a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"retryCount",{get:function(){var a=Math.max;return a(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bufferedAmount",{get:function(){var a=this._messageQueue.reduce(function(a,b){return a+="string"==typeof b?b.length:b instanceof Blob?b.size:b.byteLength,a},0);return a+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?a.CLOSED:a.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),a.prototype.close=function(a,b){return void 0===a&&(a=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState===this.CLOSED?void this._debug("close: already closed"):void this._ws.close(a,b):void this._debug("close enqueued: no ws instance")},a.prototype.reconnect=function(a,b){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(a,b),this._connect()):this._connect()},a.prototype.send=function(a){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",a),this._ws.send(a);else{var b=this._options.maxEnqueuedMessages,c=void 0===b?m.maxEnqueuedMessages:b;this._messageQueue.length<c&&(this._debug("enqueue",a),this._messageQueue.push(a))}},a.prototype.addEventListener=function(a,b){this._listeners[a]&&this._listeners[a].push(b)},a.prototype.dispatchEvent=function(a){var b,c,e=this._listeners[a.type];if(e)try{for(var f,g=d(e),h=g.next();!h.done;h=g.next())f=h.value,this._callEventListener(a,f)}catch(a){b={error:a}}finally{try{h&&!h.done&&(c=g.return)&&c.call(g)}finally{if(b)throw b.error}}return!0},a.prototype.removeEventListener=function(a,b){this._listeners[a]&&(this._listeners[a]=this._listeners[a].filter(function(a){return a!==b}))},a.prototype._debug=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this._options.debug&&console.log.apply(console,f(["RWS>"],a))},a.prototype._getNextDelay=function(){var a=Math.pow,b=this._options,c=b.reconnectionDelayGrowFactor,d=void 0===c?m.reconnectionDelayGrowFactor:c,e=b.minReconnectionDelay,f=void 0===e?m.minReconnectionDelay:e,g=b.maxReconnectionDelay,h=void 0===g?m.maxReconnectionDelay:g,i=0;return 0<this._retryCount&&(i=f*a(d,this._retryCount-1),i>h&&(i=h)),this._debug("next delay",i),i},a.prototype._wait=function(){var a=this;return new Promise(function(b){setTimeout(b,a._getNextDelay())})},a.prototype._getNextUrl=function(a){if("string"==typeof a)return Promise.resolve(a);if("function"==typeof a){var b=a();if("string"==typeof b)return Promise.resolve(b);if(!!b.then)return b}throw Error("Invalid URL")},a.prototype._connect=function(){var a=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var b=this._options,c=b.maxRetries,d=void 0===c?m.maxRetries:c,e=b.connectionTimeout,f=void 0===e?m.connectionTimeout:e,g=b.WebSocket,h=void 0===g?k():g;if(this._retryCount>=d)return void this._debug("max retries reached",this._retryCount,">=",d);if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!l(h))throw Error("No valid WebSocket class provided");this._wait().then(function(){return a._getNextUrl(a._url)}).then(function(b){a._closeCalled||(a._debug("connect",{url:b,protocols:a._protocols}),a._ws=a._protocols?new h(b,a._protocols):new h(b),a._ws.binaryType=a._binaryType,a._connectLock=!1,a._addListeners(),a._connectTimeout=setTimeout(function(){return a._handleTimeout()},f))})}},a.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new i(Error("TIMEOUT"),this))},a.prototype._disconnect=function(a,b){if(void 0===a&&(a=1e3),this._clearTimeouts(),!!this._ws){this._removeListeners();try{this._ws.close(a,b),this._handleClose(new j(a,b,this))}catch(a){}}},a.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},a.prototype._callEventListener=function(a,b){"handleEvent"in b?b.handleEvent(a):b(a)},a.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},a.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},a.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},a}();b.exports=n},{}],2:[function(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),Object.defineProperty(a,"prototype",{writable:!1}),a}var e=function(a){return a&&a.__esModule?a:{default:a}}(a("reconnecting-websocket")),f=function(){function a(){b(this,a),this.ws=null,this.queue=[],this.timeout=null,this.wsURL=null,this.SEND_TIMEOUT=500,this.DISCONNECT_TIMEOUT=1e3}return d(a,[{key:"isConnected",get:function(){return this.ws&&this.ws.readyState===this.ws.OPEN}},{key:"connect",value:function(a){var b=this;this.ws&&this.wsURL!==a&&this.isConnected&&this.ws.close(),this.wsURL=a,this.ws=new e["default"](this.wsURL,"emscripten-trace",{maxRetries:1/0,connectionTimeout:1e4,minUptime:1e3,maxReconnectInterval:1e3,reconnectDecay:1,debug:!0}),this.ws.onmessage=function(a){return b._onMessage(a.data)}}},{key:"disconnect",value:function(){return console.log("disconnect!!!"),0<this.queue.length?(this._scheduleSend(1),setTimeout(this.disconnect,this.DISCONNECT_TIMEOUT)):isConnected?this.ws.close():void 0}},{key:"send",value:function(a){this.queue.push({id:this._generateID(),message:a}),this._scheduleSend()}},{key:"_onMessage",value:function(a){console.log("Got response");try{var b=JSON.parse(a);b.length&&(this.queue=this.queue.filter(function(a){return!b.includes(a.id)}))}catch(a){console.error("Receieved message is not a JSON string")}}},{key:"_scheduleSend",value:function(a){clearTimeout(this.timeout),this.timeout=setTimeout(this._sendQueue.bind(this),a||this.SEND_TIMEOUT)}},{key:"_sendQueue",value:function(){return 0===this.queue.length?void 0:this.isConnected?void(console.log("Sending queue..."),this.ws.send(JSON.stringify(this.queue))):this._scheduleSend()}},{key:"_generateID",value:function(){return Math.random().toString(36).slice(2)}}]),a}(),g=new f;self.addEventListener("message",function(a){var b=a.data,c=b.cmd;if("post"===c)g.send(b.entry);else if("configure"===c){var d=b.url.replace(/^http/,"ws");g.connect("".concat(d,"?version=").concat(b.data_version,"&session=").concat(b.session_id))}else"close"===c&&(console.log("WANT TO CLOSE"),g.disconnect())},!1)},{"reconnecting-websocket":1}]},{},[2]);