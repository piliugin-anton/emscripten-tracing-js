(function(){function b(d,e,g){function a(j,i){if(!e[j]){if(!d[j]){var f="function"==typeof require&&require;if(!i&&f)return f(j,!0);if(h)return h(j,!0);var c=new Error("Cannot find module '"+j+"'");throw c.code="MODULE_NOT_FOUND",c}var k=e[j]={exports:{}};d[j][0].call(k.exports,function(b){var c=d[j][1][b];return a(c||b)},k,k.exports,b,d,e,g)}return e[j].exports}for(var h="function"==typeof require&&require,c=0;c<g.length;c++)a(g[c]);return a}return b})()({1:[function(a,b,c){!function(a,d){"object"==typeof c&&"undefined"!=typeof b?b.exports=d():"function"==typeof define&&define.amd?define(d):(a="undefined"==typeof globalThis?a||self:globalThis).WebsocketReconnect=d()}(this,function(){"use strict";function a(a,b){function c(){this.constructor=a}if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+(b+"")+" is not a constructor or null");f(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function b(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,f,e=c.call(a),g=[];try{for(;(void 0===b||0<b--)&&!(d=e.next()).done;)g.push(d.value)}catch(a){f={error:a}}finally{try{d&&!d.done&&(c=e.return)&&c.call(e)}finally{if(f)throw f.error}}return g}function d(){for(var a=[],c=0;c<arguments.length;c++)a=a.concat(b(arguments[c]));return a}var f=function(a,b){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,b)},g=function(){return(g=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},h=function(a,b){this.target=b,this.type=a},i=function(b){function c(a,c){var d=b.call(this,"error",c)||this;return d.message=a.message,d.error=a,d}return a(c,b),c}(h),j=function(b){function c(a,c,d){void 0===a&&(a=1e3),void 0===c&&(c="");var e=b.call(this,"close",d)||this;return e.wasClean=!0,e.code=a,e.reason=c,e}return a(c,b),c}(h),c=function(){if("undefined"!=typeof WebSocket)return WebSocket};return function(){function a(a,b,d){var f=this;void 0===d&&(d={}),this._binaryType="blob",this._messageQueue=[],this._listeners={error:[],message:[],open:[],close:[],reconnect:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._closeCalled=!1,this._pingIntervalId=0,this._pongTimeoutId=0,this._nextConnectDelay=0,this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.onreconnect=null,this.onWebsocketError=null,this._handleOpen=function(a){f._debug("open event");var b=f._options.minUptime;clearTimeout(f._connectTimeout),f._uptimeTimeout=setTimeout(function(){return f._acceptOpen()},b),f._ws&&(f._ws.binaryType=f._binaryType),f._options.enableHeartbeat&&f._heartCheck(),f._messageQueue.forEach(function(a){var b;return null===(b=f._ws)||void 0===b?void 0:b.send(a)}),f._messageQueue=[],f.onopen&&f.onopen(a),f._listeners.open.forEach(function(b){return f._callEventListener(a,b)})},this._handleMessage=function(a){(a.data!==f._options.pingMsg&&""!==a.data||(clearTimeout(f._pongTimeoutId),f._debug("pong"),f._options.outputPingMsg))&&(f._debug("message event"),f.onmessage&&f.onmessage(a),f._listeners.message.forEach(function(b){return f._callEventListener(a,b)}))},this._handleClose=function(a){f._debug("close event"),f._clearTimeouts(),f._shouldReconnect&&f._connect(),f.onclose&&f.onclose(a),f._listeners.close.forEach(function(b){return f._callEventListener(a,b)})},this._handleError=function(a){f._debug("error event",a.message),f._disconnect(void 0,"TIMEOUT"===a.message?"timeout":void 0),f.onerror&&f.onerror(a),f._debug("exec error listeners"),f._listeners.error.forEach(function(b){return f._callEventListener(a,b)}),f._connect()},this._handleReconnect=function(){f._debug("reconnect event");var a=f._options.maxRetries;f.onreconnect&&f.onreconnect({maxRetries:a,reconnectDelay:f._nextConnectDelay,retryCount:f._retryCount}),f._listeners.reconnect.forEach(function(b){return f._callEventListener({maxRetries:a,reconnectDelay:f._nextConnectDelay,retryCount:f._retryCount},b)})},this._url=a,this._protocols=null==b?"":b,this._options=g({WebSocket:c(),maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,enableHeartbeat:!1,pingTimeout:1e4,pongTimeout:1e4,pingMsg:"\r\n",outputPingMsg:!1,debug:!1},d),this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(a.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(a){this._binaryType=a,this._ws&&(this._ws.binaryType=a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"messageQueue",{get:function(){return this._messageQueue},set:function(a){this._messageQueue=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce(function(a,b){return a+="string"==typeof b?b.length:b instanceof Blob?b.size:b.byteLength,a},0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?WebSocket.CLOSED:WebSocket.CLOSING},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"ws",{get:function(){return this._ws},enumerable:!1,configurable:!0}),Object.defineProperty(a,"CONNECTING",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(a,"OPEN",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(a,"CLOSING",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(a,"CLOSED",{get:function(){return 3},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"CONNECTING",{get:function(){return WebSocket.CONNECTING},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"OPEN",{get:function(){return WebSocket.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"CLOSING",{get:function(){return WebSocket.CLOSING},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"CLOSED",{get:function(){return WebSocket.CLOSED},enumerable:!1,configurable:!0}),a.prototype.close=function(a,b){this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState===this.CLOSED?this._debug("close: already closed"):this._ws.close(a,b):this._debug("close enqueued: no ws instance")},a.prototype.send=function(a){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",a),this._ws.send(a);else{var b=this._options.maxEnqueuedMessages;this._messageQueue.length<b&&(this._debug("enqueue",a),this._messageQueue.push(a))}},a.prototype.addEventListener=function(a,b){this._listeners[a]&&this._listeners[a].push(b)},a.prototype.removeEventListener=function(a,b){this._listeners[a]&&(this._listeners=this._listeners[a].filter(function(a){return a!==b}))},a.prototype.dispatchEvent=function(a){var b,c,d=this._listeners[a.type];if(d)try{for(var e,f=function(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}(d),g=f.next();!g.done;g=f.next())e=g.value,this._callEventListener(a,e)}catch(a){b={error:a}}finally{try{g&&!g.done&&(c=f.return)&&c.call(f)}finally{if(b)throw b.error}}return!0},a.prototype._callEventListener=function(a,b){"handleEvent"in b?b.handleEvent(a):b(a)},a.prototype.reconnect=function(a,b){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==WebSocket.CLOSED?(this._disconnect(a,b),this._connect()):this._connect()},a.prototype._connect=function(){var a=this;if(this._debug("connect","_connectLock",this._connectLock,"_shouldReconnect",this._shouldReconnect),!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var b=this._options,c=b.maxRetries,d=b.connectionTimeout,e=b.WebSocket;if(this._retryCount>=c)this._debug("max retries reached",this._retryCount,">=",c);else{if(this._retryCount++,this._debug("connect times",this._retryCount),this._removeListeners(),void 0===(f=e)||!f||2!==f.CLOSING)throw Error("No valid WebSocket class provided");var f,g=this._getNextDelay();this._nextConnectDelay=g,this._debug("connect wait",g),1<=this._retryCount&&this._handleReconnect(),this._wait(g).then(function(){return a._getNextUrl(a._url)}).then(function(b){if(!a._closeCalled){a._debug("connect",{url:b,protocols:a._protocols});try{a._ws=a._protocols?new e(b,a._protocols):new e(b),a._ws.binaryType=a._binaryType,a._connectLock=!1,a._addEventListeners()}catch(b){if(!a.onWebsocketError)throw b;a.onWebsocketError(b)}a._connectTimeout=setTimeout(function(){return a._handleTimeout()},d)}})}}},a.prototype._disconnect=function(a,b){if(void 0===a&&(a=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(a,b),this._handleClose(new j(a,b,this))}catch(a){throw Error(a)}}},a.prototype._wait=function(a){return void 0===a&&(a=0),new Promise(function(b){setTimeout(function(){b()},a)})},a.prototype._getNextDelay=function(){var a=this._options,b=a.reconnectionDelayGrowFactor,c=a.minReconnectionDelay,d=a.maxReconnectionDelay,e=0;return 0<this._retryCount&&(e=c*Math.pow(b,this._retryCount))>d&&(e=d),e=Math.ceil(e),this._debug("next delay",e),e},a.prototype._getNextUrl=function(a){if("string"==typeof a)return Promise.resolve(a);if("function"==typeof a){var b=a();if("string"==typeof b)return Promise.resolve(b);if(void 0!==b.then)return b}throw Error("Invalid URL")},a.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new i(Error("TIMEOUT"),this))},a.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},a.prototype._debug=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(this._options.debug){var e=new Date,f=e.getHours();f=10>f?"0"+f:f;var g=e.getMinutes();g=10>g?"0"+g:g;var h=e.getSeconds();h=10>h?"0"+h:h;var j=e.getMilliseconds();j=100>j?10>j?"00"+j:"0"+j:j,console.log.apply(console,d(["[WSR]",f+":"+g+":"+h+"."+j],a))}},a.prototype._addEventListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("error",this._handleError))},a.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("error",this._handleError))},a.prototype._heartCheck=function(){this._heartReset(),this._heartStart()},a.prototype._heartStart=function(){var a=this,b=this._options,c=b.enableHeartbeat,d=b.pingTimeout,e=b.pongTimeout,f=b.pingMsg;(this._shouldReconnect||c)&&(this._pingIntervalId=setInterval(function(){a._debug("ping"),a.send(f),a._pongTimeoutId=setTimeout(function(){a._debug("Pong Timeout"),a.reconnect()},e)},d))},a.prototype._heartReset=function(){clearInterval(this._pingIntervalId),clearTimeout(this._pongTimeoutId)},a.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout),this._heartReset()},a}()})},{}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}var h=d(a("websocket-reconnect-pro")),i=function(){function a(){e(this,a),this.ws=null,this.queue=[],this.timeout=null,this.wsURL=null,this.SEND_TIMEOUT=500,this.DISCONNECT_TIMEOUT=1e3}return g(a,[{key:"isConnected",get:function a(){return this.ws&&this.ws.readyState===this.ws.OPEN}},{key:"connect",value:function b(a){var c=this;this.ws&&this.wsURL!==a&&this.isConnected&&this.ws.close(),this.wsURL=a,this.ws=new h["default"](this.wsURL,"emscripten-trace",{minUptime:1e3,minReconnectionDelay:1e3,maxReconnectionDelay:1e4,connectionTimeout:5e3,reconnectionDelayGrowFactor:1.1,maxRetries:1/0,maxEnqueuedMessages:0,startClosed:!1,enableHeartbeat:!1,debug:!1}),this.ws.onmessage=function(a){return c._onMessage(a.data)},this.ws.onopen=function(){return c._scheduleSend()}}},{key:"disconnect",value:function a(){return 0<this.queue.length?(this._scheduleSend(0),setTimeout(this.disconnect,this.DISCONNECT_TIMEOUT)):isConnected?this.ws.close():void 0}},{key:"send",value:function b(a){this.queue.push(a),this._scheduleSend()}},{key:"_onMessage",value:function b(a){this.queue.splice(0,+a)}},{key:"_scheduleSend",value:function b(a){clearTimeout(this.timeout),this.timeout=setTimeout(this._sendQueue.bind(this),a||this.SEND_TIMEOUT)}},{key:"_sendQueue",value:function a(){return 0===this.queue.length?void 0:this.isConnected?void this.ws.send(JSON.stringify({traces:this.queue,length:this.queue.length})):this._scheduleSend()}}]),a}(),j=new i;self.addEventListener("message",function(a){var b=a.data,c=b.cmd;if("post"===c)j.send(b.entry);else if("configure"===c){var d=b.url.replace(/^http/,"ws");j.connect("".concat(d,"?version=").concat(b.data_version,"&session=").concat(b.session_id))}else"close"===c&&(console.log("WANT TO CLOSE"),j.disconnect())},!1)},{"websocket-reconnect-pro":1}]},{},[2]);